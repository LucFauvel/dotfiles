Some code yoinked from ([@Hacksore](https://github.com/Hacksore) which he probably yoiked somewhere else
